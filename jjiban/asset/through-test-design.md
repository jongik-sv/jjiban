# JJIBAN 관통(프로세스) 테스트 설계

## 목적
- jjiban의 현행 워크플로우(`/wf:test`, `/wf:verify`)를 유지하면서, **사용자 프로세스 전체를 검증하는 관통 테스트(Through/System Test)**를 공식 게이트로 추가한다.
- 테스트를 **Task → ACT → WP/Project**로 계층화해 결함의 조기 발견과 회귀 방지를 동시에 달성한다.

---

## 용어와 범위
- **TDD(단위 테스트)**: 함수/모듈 단위의 로직 검증. 빠른 피드백, 결함 위치 추적이 쉬움.
- **E2E 테스트**: UI/사용자 관점에서 화면·API·스토어가 함께 동작하는지 검증.
- **Task‑레벨 통합 테스트**: 하나의 기능 Task가 주변 모듈과 정상적으로 붙는지 확인하는 얇은 통합/스모크 테스트.
- **관통(Through/System) 테스트**: 여러 Task/WP가 모여 **업무/사용자 시나리오가 처음부터 끝까지 끊김 없이 수행되는지** 검증하는 두꺼운 통합/회귀 테스트.

---

## 테스트 케이스를 언제 만드는가
통합/관통 테스트 케이스는 “마지막에 몰아서”가 아니라 **상세설계 종료~구현 시작 직전에 초안을 만들고, 구현과 함께 보정**한다.

- **상세설계 단계(구현 전)**:  
  - 요구사항/추적성(Traceability)에서 모듈 간 상호작용, 사용자 흐름, 데이터 흐름을 뽑아 **통합·관통 시나리오 초안**을 정의한다.
  - 케이스는 구체적 입력/기대값/검증 지점을 포함하되, 구현 세부가 바뀌면 갱신 가능한 형태로 둔다.
- **구현 단계**:  
  - 실제 API·UX·데이터 구조 확정에 따라 케이스를 **구체화/업데이트**하고 자동화 스크립트(Playwright 등)로 전환한다.

즉, 테스트 케이스는 **설계에서 정의 → 구현에서 확정/자동화**되는 “살아있는 문서”로 운영한다.

---

## `/wf:test` vs `/wf:verify` 사용 가이드

### `/wf:test`
- 목적: **TDD + E2E 테스트를 실행**해 품질을 확인한다.
- 상태 변화: **없음**(반복 실행 가능).
- 적용 범위: **development Task만**(WP/ACT 입력 시에도 development만 필터).
- 옵션: `--type tdd|e2e|all`.
- 사용 시점:
  - 구현 중(`[dd]`, `[im]`) 수시 실행.
  - 리팩터링/패치 후 회귀 체크.
  - `/wf:verify`, `/wf:done` 전에 사전 통과 확인.

### `/wf:verify`
- 목적: **구현/수정 완료를 전제로 통합·검증 단계로 전환**하고 결과를 문서화한다.
- 상태 변화:
  - development: `[im] → [ts]` (통합테스트 시작)
  - defect: `[fx] → [ts]` (검증/테스트 시작)
- 적용 범위: **development + defect**.
- 산출 문서:
  - development: `070-integration-test.md`
  - defect: `070-test-results.md`
- 사용 시점:
  - 기능 Task가 완료 상태(`[im]` 또는 `[fx]`)이고 단위/E2E가 통과했을 때
  - “검증 컬럼(ts)로 이동시키며 공식 결과를 남길 때”

---

## 테스트 단위 계층(권장 운영)
관통 테스트를 “마지막에 한 번”만 돌리면 결함 추적 비용이 급증한다.  
따라서 **작게 자주(얇게), 크게 주기적으로(두껍게)** 검증한다.

- **Task 단계**:  
  - `/wf:test`로 TDD/E2E 반복 실행.  
  - 기능 완료 후 `/wf:verify TSK-…`로 **Task‑레벨 통합/스모크**를 공식 기록.
- **ACT/WP 단계**:  
  - 기능 묶음이 완성되면 `/wf:verify ACT-…` 또는 `/wf:verify WP-…`로 **본격 통합 테스트와 공식 기록**.
- **릴리즈/마일스톤 단계**:  
  - **관통 테스트 게이트**에서 사용자 프로세스 전체를 E2E로 재검증.

---

## 관통(프로세스) 테스트 단계 설계
현행 워크플로우 위에 **Through/System Test 게이트를 WBS로 표현**한다(추가 상태·커맨드 없이 시작 가능).

### 1) WBS 모델링
- 프로젝트 내에 전용 테스트 묶음을 둔다.
  - **WP‑SYS (또는 WP‑00 System Test)**: 프로젝트 전체 관통 테스트 묶음.
  - 하위 **ACT‑THROUGH‑xx**: 특정 관통 시나리오 그룹.
  - ACT 아래에 **시나리오 Task**를 생성해 자동화/E2E 실행 단위로 사용한다.

### 2) 시나리오 Task 규칙
- `category`: `development`  
  - `/wf:test`의 적용 범위에 들어 E2E 자동 실행 가능.
- `labels`: `["through"]`  
  - 관통 시나리오임을 명시하고 필터링 근거 제공.
- `blockedBy`/`dependencies`:  
  - 이 시나리오가 커버하는 기능 Task ID를 연결해 **선행 조건 및 커버리지 추적**.
- 상태 흐름:
  - 시나리오 제작/자동화 중에는 `/wf:test --type e2e`로 반복 실행(상태 변화 없음).
  - 릴리즈/마일스톤 전 공식 실행 시 `/wf:verify ACT‑THROUGH‑xx` 또는 `/wf:verify WP‑SYS`로 `[im] → [ts]` 전환 + 결과 기록.
  - 통과 시 `/wf:done`으로 시나리오 Task 종료.

### 3) 산출물(문서)
- 시나리오 Task별 결과: 기존 `070-integration-test.md` 사용.
- **ACT/WP 관통 요약 문서(권장 추가)**:
  - 파일명: `071-through-test.md`
  - 위치: `.jjiban/{project}/wbs/WP‑SYS/ACT‑THROUGH‑xx/`
  - 내용:
    - 커버한 시나리오 목록(각 Task 링크)
    - 통과/실패 요약
    - 주요 결함/리그레션
    - 재실행 필요 범위 및 다음 조치

### 4) 관통 게이트 실행 조건/타이밍
- 조건: 해당 시나리오의 `blockedBy` 기능 Task들이 모두 `[xx]`(Done).
- 타이밍:
  - WP 기능 묶음 완료 시점(스프린트/마일스톤)
  - 릴리즈 후보 빌드 직전
  - 대규모 플로우 변경/리팩터링 직후(회귀)

---

## 예시 운영 시나리오
1. 기능 Task 구현 중  
   - `/wf:test TSK-01-02-03 --type all` 반복 → 문제 수정 → 다시 테스트
2. 기능 Task 완료  
   - `/wf:verify TSK-01-02-03` → `[im] → [ts]` 전환, `070-integration-test.md` 기록
   - 통과 시 `/wf:done TSK-01-02-03`
3. 관통 시나리오 준비  
   - WP‑SYS / ACT‑THROUGH‑01 생성
   - 시나리오 Task(`labels:["through"]`) 작성 후 `/wf:test --type e2e` 반복
4. 마일스톤 관통 게이트  
   - `/wf:verify ACT-THROUGH-01` → 시나리오 Task 공식 실행/기록
   - 통과 후 `/wf:done ACT-THROUGH-01` 및 `071-through-test.md` 요약 작성

---

## 향후 확장(선택)
관통 테스트 자동화를 더 강화하려면 별도 커맨드를 추가할 수 있다.
- `/wf:through WP‑SYS|ACT‑THROUGH‑xx`
  - `labels:["through"]` Task만 모아 E2E 일괄 실행
  - `071-through-test.md` 자동 생성
  - 실패 시 defect Task 자동 생성까지 확장 가능

초기 도입은 **WBS 전용 WP/ACT + 기존 `/wf:test`/`/wf:verify` 운영**으로 충분하다.

