# CLI 인터페이스 설계 (011-ui-design.md)

**Version:** 1.0.0 — **Last Updated:** 2025-12-17

> **참고**: 이 Task는 CLI 명령어로 GUI 화면이 없습니다.
> 화면설계 대신 CLI 인터페이스 설계를 문서화합니다.

---

## 0. 문서 메타데이터

| 항목 | 내용 |
|------|------|
| Task ID | TSK-03-03 |
| Task명 | 워크플로우 명령어 훅 |
| Category | development |
| 상태 | [bd] 기본설계 |
| 작성일 | 2025-12-17 |
| 작성자 | Claude |

---

## 1. CLI 명령어 목록

| 명령어 | 설명 |
|--------|------|
| `npx jjiban exec start` | 실행 상태 시작 등록 |
| `npx jjiban exec stop` | 실행 상태 종료 등록 |

---

## 2. 명령어 상세

### 2.1 exec start

**사용법**:
```
npx jjiban exec start <taskId> <command> [options]
```

**인자**:

| 인자 | 필수 | 설명 | 예시 |
|------|------|------|------|
| taskId | Yes | Task ID | TSK-01-01 |
| command | Yes | 워크플로우 명령어 | build, start, draft |

**옵션**:

| 옵션 | 축약 | 설명 | 기본값 |
|------|------|------|--------|
| --session | -s | 터미널 세션 ID | $JJIBAN_SESSION_ID |
| --pid | -p | 터미널 프로세스 PID | $JJIBAN_TERMINAL_PID |

**출력 예시 - 성공**:
```
[exec] 실행 등록: TSK-01-01 (build)
```

**출력 예시 - 실패**:
```
[exec] 경고: 실행 등록 실패 - 서버 연결 불가
```

---

### 2.2 exec stop

**사용법**:
```
npx jjiban exec stop <taskId>
```

**인자**:

| 인자 | 필수 | 설명 | 예시 |
|------|------|------|------|
| taskId | Yes | Task ID | TSK-01-01 |

**출력 예시 - 성공**:
```
[exec] 실행 해제: TSK-01-01
```

**출력 예시 - 실패**:
```
[exec] 경고: 실행 해제 실패 - 등록된 실행 없음
```

---

## 3. 환경변수

| 환경변수 | 설명 | 설정 주체 |
|----------|------|----------|
| JJIBAN_SESSION_ID | 터미널 세션 ID | TerminalService (서버) |
| JJIBAN_TERMINAL_PID | 터미널 프로세스 PID | TerminalService (서버) |

**환경변수 우선순위**:
1. CLI 옵션 (`--session`, `--pid`)
2. 환경변수 (`$JJIBAN_SESSION_ID`, `$JJIBAN_TERMINAL_PID`)

---

## 4. 워크플로우 훅 삽입 위치

### 4.1 슬래시 명령어 구조

```markdown
# /wf:{command} 명령어

## 시작 훅 (실행 등록)
<!-- 명령어 시작 직후 -->

## 워크플로우 로직
<!-- 기존 로직 -->

## 종료 훅 (실행 해제)
<!-- 명령어 종료 직전 -->
```

### 4.2 훅 스크립트 형식

**시작 훅**:
```bash
npx jjiban exec start {TASK_ID} {COMMAND}
```

**종료 훅**:
```bash
npx jjiban exec stop {TASK_ID}
```

---

## 5. 실행 흐름 다이어그램

```
┌─────────────────────────────────────────────────────────────┐
│ 터미널 세션 시작                                              │
│   ↓ 환경변수 설정: JJIBAN_SESSION_ID, JJIBAN_TERMINAL_PID     │
├─────────────────────────────────────────────────────────────┤
│ 사용자: /wf:build TSK-01-01                                  │
│   ↓                                                          │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [시작 훅]                                                │ │
│ │ $ npx jjiban exec start TSK-01-01 build                 │ │
│ │ [exec] 실행 등록: TSK-01-01 (build)                      │ │
│ └─────────────────────────────────────────────────────────┘ │
│   ↓                                                          │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [워크플로우 로직]                                         │ │
│ │ ... TDD 구현, 테스트, 커밋 ...                            │ │
│ └─────────────────────────────────────────────────────────┘ │
│   ↓                                                          │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [종료 훅]                                                │ │
│ │ $ npx jjiban exec stop TSK-01-01                        │ │
│ │ [exec] 실행 해제: TSK-01-01                              │ │
│ └─────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

---

## 6. 에러 처리 정책

| 상황 | 처리 | 출력 |
|------|------|------|
| API 서버 미기동 | 경고 후 계속 | `[exec] 경고: 서버 연결 불가` |
| 환경변수 없음 | CLI 옵션 사용 | - |
| CLI 옵션도 없음 | 경고 후 계속 | `[exec] 경고: 세션 정보 없음` |
| 네트워크 오류 | 경고 후 계속 | `[exec] 경고: 네트워크 오류` |

**원칙**: 훅 실패로 워크플로우를 중단하지 않음

---

## 7. 터미널 출력 스타일

### 7.1 접두사

| 상황 | 접두사 | 색상 |
|------|--------|------|
| 정보 | `[exec]` | 기본 |
| 성공 | `[exec]` | 녹색 |
| 경고 | `[exec] 경고:` | 노란색 |
| 오류 | `[exec] 오류:` | 빨간색 |

### 7.2 출력 예시

```
$ npx jjiban exec start TSK-01-01 build
[exec] 실행 등록: TSK-01-01 (build)

$ npx jjiban exec stop TSK-01-01
[exec] 실행 해제: TSK-01-01

$ npx jjiban exec start TSK-01-01 build
[exec] 경고: 서버 연결 불가 - 계속 진행
```

---

## 8. 관련 문서

- 기본설계: `010-basic-design.md`
- PRD 섹션 9.6, 9.7: 워크플로우 명령어 훅

---

<!--
author: Claude
Version: 1.0.0
Note: CLI Task - 화면 대신 CLI 인터페이스 설계
-->
