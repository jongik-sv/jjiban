# PRD: jjibanê°œì„  - ì›¹ í„°ë¯¸ë„ ê¸°ë°˜ ì›Œí¬í”Œë¡œìš° ëª…ë ¹ì–´ ì‹¤í–‰ (2ì°¨)

## ë¬¸ì„œ ì •ë³´

| í•­ëª© | ë‚´ìš© |
|------|------|
| ë¬¸ì„œ ë²„ì „ | 1.5 |
| ì‘ì„±ì¼ | 2025-12-18 |
| ë²”ìœ„ | 2ì°¨ (í„°ë¯¸ë„ í†µí•© + ì›Œí¬í”Œë¡œìš° ì‹¤í–‰) |
| ìƒíƒœ | Draft |
| ì„ í–‰ PRD | jjiban PRD 1.0 (WBS íŠ¸ë¦¬ ë·° ì¤‘ì‹¬) |

---

## 1. ì œí’ˆ ê°œìš”

### 1.1 ê¸°ëŠ¥ ë¹„ì „

**"LLM CLI ì›Œí¬í”Œë¡œìš°ë¥¼ ì›¹ UIì—ì„œ ì§ì ‘ ì‹¤í–‰"**

Task ìƒì„¸ íŒ¨ë„ì— í†µí•©ëœ xterm.js í„°ë¯¸ë„ì—ì„œ `/wf:*` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬, Claude Code ë“± LLM CLIì˜ ì›Œí¬í”Œë¡œìš°ë¥¼ ì›¹ UIì—ì„œ ì§ì ‘ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 1.2 í•µì‹¬ ê°€ì¹˜

| ê°€ì¹˜ | ì„¤ëª… |
|------|------|
| ì‹¤ì‹œê°„ ê°€ì‹œì„± | í„°ë¯¸ë„ ì¶œë ¥ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸ |
| ì›í´ë¦­ ì‹¤í–‰ | Task ìƒì„¸ì—ì„œ ë°”ë¡œ ì›Œí¬í”Œë¡œìš° ëª…ë ¹ì–´ ì‹¤í–‰ |
| ì„¸ì…˜ ê´€ë¦¬ | ì—¬ëŸ¬ Taskì˜ í„°ë¯¸ë„ ì„¸ì…˜ì„ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ |
| ìƒíƒœ ë™ê¸°í™” | ì›Œí¬í”Œë¡œìš° ì™„ë£Œ ì‹œ wbs.md ìƒíƒœ ìë™ ë°˜ì˜ |

### 1.3 ë²”ìœ„

**í¬í•¨:**
- xterm.js í„°ë¯¸ë„ íŒ¨ë„ (Task Detail í•˜ë‹¨)
- node-pty ê¸°ë°˜ ì„œë²„ í„°ë¯¸ë„ ì„¸ì…˜
- ì›Œí¬í”Œë¡œìš° ëª…ë ¹ì–´ 15ê°œ ë²„íŠ¼ UI
- í„°ë¯¸ë„ ì„¸ì…˜ ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬
- **ì‹¤í–‰ ìƒíƒœ ì‹œê°í™”** (WBS íŠ¸ë¦¬ ìŠ¤í”¼ë„ˆ)
- **ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€** (ë™ì¼ Task ì¬ì‹¤í–‰ ì°¨ë‹¨)
- **Stale Execution ì •ë¦¬** (1ì‹œê°„ íƒ€ì„ì•„ì›ƒ)

**ì œì™¸ (3ì°¨ ë²”ìœ„):**
- ë‹¤ì¤‘ í„°ë¯¸ë„ íƒ­
- í„°ë¯¸ë„ ì„¸ì…˜ íˆìŠ¤í† ë¦¬ ì €ì¥
- í„°ë¯¸ë„ í…Œë§ˆ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### 1.4 í„°ë¯¸ë„ ì‹¤í–‰ ì•„í‚¤í…ì²˜

**ë‹¨ì¼ ì‹¤í–‰ ë©”ì»¤ë‹ˆì¦˜**

ì›Œí¬í”Œë¡œìš° ë²„íŠ¼ì€ í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´ë§Œ ìƒì„±í•˜ê³ , í„°ë¯¸ë„ì—ì„œ ì§ì ‘ ì‹¤í–‰í•©ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì›¹ UI                                                           â”‚
â”‚   [build] í´ë¦­                                                  â”‚
â”‚      â†“                                                          â”‚
â”‚   í”„ë¡¬í”„íŠ¸ ìƒì„±: "/wf:build TSK-01-01"                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ í„°ë¯¸ë„ (xterm.js + node-pty)                                    â”‚
â”‚   â†“ í”„ë¡¬í”„íŠ¸ ì…ë ¥                                               â”‚
â”‚   $ /wf:build TSK-01-01                                         â”‚
â”‚   â†“ Claude Code ì‹¤í–‰                                            â”‚
â”‚   [wf:build] ì‹œì‘...                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SSE â† stdout/stderr                                             â”‚
â”‚   â†“                                                             â”‚
â”‚ ì›¹ í„°ë¯¸ë„ ì¶œë ¥                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬ ë‹¨ìˆœí™”:**
- ì„œë²„ëŠ” í„°ë¯¸ë„ ì„¸ì…˜ë§Œ ê´€ë¦¬ (ìƒì„±/ì¢…ë£Œ/ì…ì¶œë ¥)
- ëª…ë ¹ì–´ë³„ ë¡œì§ ë¶ˆí•„ìš” - í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´ë§Œ ìƒì„±
- ê¸°ì¡´ `/wf:*` ëª…ë ¹ì–´ê°€ í„°ë¯¸ë„ì—ì„œ ê·¸ëŒ€ë¡œ ì‹¤í–‰

---

## 2. ì›Œí¬í”Œë¡œìš° ì‹œìŠ¤í…œ

### 2.1 ì›Œí¬í”Œë¡œìš° ëª…ë ¹ì–´ (15ê°œ)

| ëª…ë ¹ì–´ | ì„¤ëª… | ì¹´í…Œê³ ë¦¬ | ìƒíƒœ ì „í™˜ |
|--------|------|----------|-----------|
| `/wf:start` | ì›Œí¬í”Œë¡œìš° ì‹œì‘ | all | `[ ]` â†’ `[bd]`/`[an]`/`[dd]` |
| `/wf:draft` | ìƒì„¸ì„¤ê³„ | dev | `[bd]` â†’ `[dd]` |
| `/wf:build` | TDD ê¸°ë°˜ êµ¬í˜„ | dev/infra | `[dd]` â†’ `[im]` |
| `/wf:ui` | í™”ë©´ì„¤ê³„ | dev | ìƒíƒœ ìœ ì§€ |
| `/wf:review` | ì„¤ê³„ ë¦¬ë·° | dev | ìƒíƒœ ìœ ì§€ |
| `/wf:apply` | ë¦¬ë·° ë°˜ì˜ | dev | ìƒíƒœ ìœ ì§€ |
| `/wf:test` | í…ŒìŠ¤íŠ¸ ì‹¤í–‰ | dev | ìƒíƒœ ìœ ì§€ |
| `/wf:audit` | ì½”ë“œ ë¦¬ë·° | dev | ìƒíƒœ ìœ ì§€ |
| `/wf:patch` | ì½”ë“œë¦¬ë·° ë°˜ì˜ | dev | ìƒíƒœ ìœ ì§€ |
| `/wf:verify` | í†µí•©í…ŒìŠ¤íŠ¸ | dev | `[im]` â†’ `[vf]` |
| `/wf:done` | ì™„ë£Œ ì²˜ë¦¬ | all | `[vf]` â†’ `[xx]` |
| `/wf:fix` | ê²°í•¨ ìˆ˜ì • | defect | `[an]` â†’ `[fx]` |
| `/wf:skip` | ì„¤ê³„ ìƒëµ | infra | `[ ]` â†’ `[dd]` |
| `/wf:run` | ë³‘ë ¬ ìë™ ì‹¤í–‰ | all | ìë™ |
| `/wf:auto` | ìˆœì°¨ ìë™ ì‹¤í–‰ | all | ìë™ |

### 2.2 ì¹´í…Œê³ ë¦¬ë³„ ëª…ë ¹ì–´ ê°€ìš©ì„±

| ìƒíƒœ | development | defect | infrastructure |
|------|-------------|--------|----------------|
| `[ ]` | start | start | start, skip |
| `[bd]` | ui, draft | - | - |
| `[dd]` | review, apply, build | - | build |
| `[an]` | - | fix | - |
| `[fx]` | - | audit, patch, verify | - |
| `[im]` | test, audit, patch, verify | - | audit, patch, done |
| `[vf]` | done | done | - |

### 2.3 ìë™ ì‹¤í–‰ ëª…ë ¹ì–´

**`/wf:run` (ë³‘ë ¬)**
- Subagent ê¸°ë°˜ ë³‘ë ¬ ì‹¤í–‰
- ì—¬ëŸ¬ Task ë™ì‹œ ì²˜ë¦¬ ê°€ëŠ¥
- `--max N`, `--parallel N` ì˜µì…˜

**`/wf:auto` (ìˆœì°¨)**
- `npx tsx .jjiban/script/next-task.ts`ë¡œ Task ìë™ ì„ íƒ
- ë‹¨ì¼ Task ì™„ë£Œê¹Œì§€ ìˆœì°¨ ì‹¤í–‰
- `--until <target>` ë¶€ë¶„ ì‹¤í–‰ ì§€ì›

---

## 3. í™”ë©´ ì„¤ê³„

### 3.1 ì „ì²´ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header: jjiban | WBS | í”„ë¡œì íŠ¸ëª…              [ğŸ–¥ï¸ N] í„°ë¯¸ë„    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ WBS Tree Panel (600px)      â”‚ Detail Panel (flex-1)             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ [ğŸ”„] TSK-01-01 (ì‹¤í–‰ì¤‘) â”‚ â”‚ â”‚ Task Detail                   â”‚ â”‚
â”‚ â”‚ â”œâ”€ TSK-01-02            â”‚ â”‚ â”‚ â”œâ”€ BasicInfo                  â”‚ â”‚
â”‚ â”‚ â””â”€ TSK-01-03            â”‚ â”‚ â”‚ â”œâ”€ Progress                   â”‚ â”‚
â”‚ â”‚                         â”‚ â”‚ â”‚ â”œâ”€ Documents                  â”‚ â”‚
â”‚ â”‚                         â”‚ â”‚ â”‚ â””â”€ History                    â”‚ â”‚
â”‚ â”‚                         â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚                         â”‚ â”‚ â”‚ Workflow Actions              â”‚ â”‚
â”‚ â”‚                         â”‚ â”‚ â”‚ [start][draft][build]...      â”‚ â”‚
â”‚ â”‚                         â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬ ë³€ê²½:**
- í„°ë¯¸ë„ì€ Task ìƒì„¸ì— ë‚´ì¥í•˜ì§€ ì•Šê³  í—¤ë” ì•„ì´ì½˜ìœ¼ë¡œ ë¶„ë¦¬
- ì‹¤í–‰ ì¤‘ì¸ ì„¸ì…˜ ê°œìˆ˜ë¥¼ ë°°ì§€ë¡œ í‘œì‹œ
- í„°ë¯¸ë„ ì•„ì´ì½˜ í´ë¦­ ì‹œ ì „ì—­ í„°ë¯¸ë„ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ

### 3.2 í„°ë¯¸ë„ ë‹¤ì´ì–¼ë¡œê·¸ (ì „ì—­ ê´€ë¦¬)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ í„°ë¯¸ë„ ì„¸ì…˜ ê´€ë¦¬                                          [X]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì„¸ì…˜ ëª©ë¡ (250px)    â”‚ í„°ë¯¸ë„ (flex-1)                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ â— TSK-01-01      â”‚ â”‚ â”‚ $ /wf:build TSK-01-01                 â”‚â”‚
â”‚ â”‚   [build] ì‹¤í–‰ì¤‘ â”‚ â”‚ â”‚ [wf:build] ì‹œì‘...                    â”‚â”‚
â”‚ â”‚ â—‹ TSK-02-01      â”‚ â”‚ â”‚ ...                                   â”‚â”‚
â”‚ â”‚   [done] ì™„ë£Œ    â”‚ â”‚ â”‚                                       â”‚â”‚
â”‚ â”‚ + ìƒˆ ì„¸ì…˜        â”‚ â”‚ â”‚                                       â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì„¤ê³„ ì´ìœ :**
- Taskì— ì¢…ì†ë˜ì§€ ì•ŠëŠ” ì „ì—­ í„°ë¯¸ë„ ê´€ë¦¬
- auto ëª…ë ¹ì–´ë¡œ Task ì™„ë£Œ í›„ ë‹¤ìŒ Task ìë™ ì‹¤í–‰ ì§€ì›
- ì—¬ëŸ¬ ì„¸ì…˜ì„ ë™ì‹œì— ê´€ë¦¬ ê°€ëŠ¥

### 3.3 ì›Œí¬í”Œë¡œìš° ì•¡ì…˜ ë°”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì›Œí¬í”Œë¡œìš°  [start][ui][draft][review][apply][build]...       â”‚
â”‚             [test][audit][patch][verify][done]                â”‚
â”‚ ìë™ì‹¤í–‰   [â–¶ run] [â–¶â–¶ auto] [â¹ ì¤‘ì§€]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 í„°ë¯¸ë„ ì„¸ì…˜ ìƒíƒœ

| ìƒíƒœ | ë¦¬ìŠ¤íŠ¸ í‘œì‹œ | í„°ë¯¸ë„ í‘œì‹œ |
|------|-------------|-------------|
| ì‹¤í–‰ ì¤‘ | â— (ë…¹ìƒ‰) + ëª…ë ¹ì–´ | xterm.js ì¶œë ¥ |
| ì™„ë£Œ | â—‹ (íšŒìƒ‰) + "ì™„ë£Œ" | ìµœì¢… ì¶œë ¥ ìœ ì§€ |
| ì—ëŸ¬ | â—‹ (ë¹¨ê°„) + "ì—ëŸ¬" | ì—ëŸ¬ ë©”ì‹œì§€ |

### 3.5 ì›Œí¬í”Œë¡œìš° ë²„íŠ¼ ìƒíƒœ

| ìƒíƒœ | ìŠ¤íƒ€ì¼ |
|------|--------|
| ì‚¬ìš© ê°€ëŠ¥ | Primary (í™œì„±) |
| ì‚¬ìš© ë¶ˆê°€ | Secondary (ë¹„í™œì„±, disabled) |
| ì‹¤í–‰ ì¤‘ | Loading spinner |
| ì™„ë£Œ | Success í† ìŠ¤íŠ¸ í‘œì‹œ |

---

## 4. API ì„¤ê³„

### 4.1 Server Routes (Nuxt)

| Method | Route | ì„¤ëª… |
|--------|-------|------|
| GET | /api/terminal/session | í„°ë¯¸ë„ ì„¸ì…˜ ìƒíƒœ ì¡°íšŒ |
| POST | /api/terminal/session | í„°ë¯¸ë„ ì„¸ì…˜ ìƒì„± |
| DELETE | /api/terminal/session/:id | í„°ë¯¸ë„ ì„¸ì…˜ ì¢…ë£Œ |
| POST | /api/terminal/session/:id/resize | í„°ë¯¸ë„ í¬ê¸° ì¡°ì • |
| GET | /api/terminal/session/:id/output | SSE ê¸°ë°˜ í„°ë¯¸ë„ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ |
| POST | /api/terminal/session/:id/input | í„°ë¯¸ë„ ì…ë ¥ ì „ì†¡ |
| POST | /api/workflow/execute | ì›Œí¬í”Œë¡œìš° ëª…ë ¹ì–´ ì‹¤í–‰ |
| GET | /api/workflow/available-commands/:taskId | Taskë³„ ì‚¬ìš© ê°€ëŠ¥ ëª…ë ¹ì–´ |

### 4.2 WebSocket vs SSE ê²°ì •

**SSE (Server-Sent Events) ì±„íƒ**

| í•­ëª© | WebSocket | SSE |
|------|-----------|-----|
| Nuxt 3 í˜¸í™˜ì„± | ì¶”ê°€ ì„¤ì • í•„ìš” | ê¸°ë³¸ ì§€ì› |
| ì–‘ë°©í–¥ í†µì‹  | O | X (ë‹¨ë°©í–¥) |
| êµ¬í˜„ ë³µì¡ë„ | ë†’ìŒ | ë‚®ìŒ |
| í„°ë¯¸ë„ ì…ë ¥ | WS í•„ìš” | POST API í™œìš© |

**ì„ íƒ ì´ìœ :**
- í„°ë¯¸ë„ ì¶œë ¥ = SSE (ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸)
- í„°ë¯¸ë„ ì…ë ¥ = POST API (í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„)
- Nuxt 3 Standalone ëª¨ë“œì—ì„œ WebSocket ì„¤ì • ë³µì¡

### 4.3 í„°ë¯¸ë„ ì„¸ì…˜ API

**POST /api/terminal/session**

Request:
```json
{
  "taskId": "TSK-01-01",
  "projectId": "jjiban",
  "cols": 80,
  "rows": 24
}
```

Response:
```json
{
  "success": true,
  "sessionId": "term-uuid-1234",
  "status": "connected",
  "createdAt": "2025-12-17T10:00:00Z"
}
```

**GET /api/terminal/session/:id/output (SSE)**

```
event: output
data: {"text": "$ /wf:start TSK-01-01\n"}

event: output
data: {"text": "[wf:start] ê¸°ë³¸ì„¤ê³„ ì‹œì‘...\n"}

event: status
data: {"status": "running", "command": "/wf:start"}

event: complete
data: {"success": true, "newStatus": "[bd]"}
```

### 4.4 ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ API

**POST /api/workflow/execute**

Request:
```json
{
  "taskId": "TSK-01-01",
  "projectId": "jjiban",
  "command": "start",
  "options": {
    "until": null,
    "skipReview": false,
    "skipAudit": false
  }
}
```

Response:
```json
{
  "success": true,
  "sessionId": "term-uuid-1234",
  "message": "ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì‹œì‘"
}
```

### 4.5 íƒ€ì… ì •ì˜

```typescript
// types/terminal.ts

interface TerminalSession {
  id: string;
  pid: number;                // í„°ë¯¸ë„ í”„ë¡œì„¸ìŠ¤ PID (node-pty)
  taskId?: string;            // ì˜µì…˜ (ì „ì—­ ê´€ë¦¬)
  projectId?: string;
  status: 'connecting' | 'connected' | 'running' | 'completed' | 'error';
  currentCommand?: string;
  createdAt: string;
  updatedAt: string;
}

interface ExecutionInfo {
  taskId: string;
  command: string;
  sessionId: string;          // í„°ë¯¸ë„ ì„¸ì…˜ ID
  pid: number;                // í„°ë¯¸ë„ í”„ë¡œì„¸ìŠ¤ PID
  startedAt: Date;
}

interface TerminalOutput {
  type: 'stdout' | 'stderr' | 'system';
  text: string;
  timestamp: string;
}

interface WorkflowCommand {
  name: string;
  label: string;
  icon: string;
  severity: 'primary' | 'secondary' | 'success' | 'info' | 'warn' | 'danger';
  availableStatuses: string[];
  categories: ('development' | 'defect' | 'infrastructure')[];
}

interface WorkflowExecuteRequest {
  taskId: string;
  projectId: string;
  command: string;
  options?: {
    until?: string;
    skipReview?: boolean;
    skipAudit?: boolean;
    dryRun?: boolean;
    maxTasks?: number;
  };
}

interface WorkflowExecuteResponse {
  success: boolean;
  sessionId?: string;
  error?: string;
}
```

---

## 5. ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

### 5.1 ì‹ ê·œ ì»´í¬ë„ŒíŠ¸

```
app/components/
â”œâ”€â”€ terminal/
â”‚   â”œâ”€â”€ TerminalDialog.vue       # í„°ë¯¸ë„ ë‹¤ì´ì–¼ë¡œê·¸ (ì „ì²´)
â”‚   â”œâ”€â”€ TerminalSessionList.vue  # ì™¼ìª½: ì„¸ì…˜ ëª©ë¡
â”‚   â”œâ”€â”€ TerminalView.vue         # ì˜¤ë¥¸ìª½: xterm.js ë˜í¼
â”‚   â””â”€â”€ TerminalHeaderIcon.vue   # í—¤ë” ì•„ì´ì½˜ + ë°°ì§€
â””â”€â”€ workflow/
    â”œâ”€â”€ WorkflowActions.vue      # ì›Œí¬í”Œë¡œìš° ì•¡ì…˜ ë°”
    â”œâ”€â”€ WorkflowButton.vue       # ê°œë³„ ëª…ë ¹ì–´ ë²„íŠ¼
    â””â”€â”€ WorkflowAutoActions.vue  # ìë™ì‹¤í–‰ ë²„íŠ¼ ê·¸ë£¹
```

### 5.2 ì»´í¬ë„ŒíŠ¸ ì±…ì„

**TerminalHeaderIcon.vue**
- í—¤ë”ì— í„°ë¯¸ë„ ì•„ì´ì½˜ í‘œì‹œ
- ì‹¤í–‰ ì¤‘ ì„¸ì…˜ ê°œìˆ˜ ë°°ì§€ í‘œì‹œ
- í´ë¦­ ì‹œ TerminalDialog ì—´ê¸°

**TerminalDialog.vue**
- PrimeVue Dialog ê¸°ë°˜ ì „ì—­ í„°ë¯¸ë„ ê´€ë¦¬
- ì¢Œìš° ë¶„í•  ë ˆì´ì•„ì›ƒ (ì„¸ì…˜ ëª©ë¡ + í„°ë¯¸ë„)
- Task ë…ë¦½ì ì¸ ì„¸ì…˜ ê´€ë¦¬

**TerminalSessionList.vue**
- ì „ì²´ í„°ë¯¸ë„ ì„¸ì…˜ ëª©ë¡ í‘œì‹œ
- ì„¸ì…˜ ì„ íƒ/ì¢…ë£Œ ê¸°ëŠ¥
- ì‹¤í–‰ ì¤‘/ì™„ë£Œ/ì—ëŸ¬ ìƒíƒœ í‘œì‹œ

**TerminalView.vue**
- xterm.js ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
- SSE ì—°ê²° ë° ì¶œë ¥ ë Œë”ë§
- í‚¤ ì…ë ¥ ì²˜ë¦¬ ë° API ì „ì†¡

**WorkflowActions.vue**
- í˜„ì¬ Task ìƒíƒœ ê¸°ë°˜ ëª…ë ¹ì–´ í•„í„°ë§
- ëª…ë ¹ì–´ ë²„íŠ¼ ê·¸ë£¹ ë Œë”ë§
- í„°ë¯¸ë„ ì„¸ì…˜ ìƒì„± ìš”ì²­

### 5.3 ìˆ˜ì • ì»´í¬ë„ŒíŠ¸

**AppHeader.vue**
```vue
<template>
  <!-- ê¸°ì¡´ ë©”ë‰´ë°” -->
  <Menubar ... />

  <!-- ì‹ ê·œ: í„°ë¯¸ë„ ì•„ì´ì½˜ -->
  <TerminalHeaderIcon />
</template>
```

**TaskDetailPanel.vue**
```vue
<template>
  <!-- ê¸°ì¡´ ì„¹ì…˜ë“¤ -->
  <WbsDetailTaskBasicInfo ... />
  <WbsDetailTaskProgress ... />
  <WbsDetailTaskDocuments ... />
  <WbsDetailTaskHistory ... />

  <!-- ì‹ ê·œ: ì›Œí¬í”Œë¡œìš° ì•¡ì…˜ (í„°ë¯¸ë„ ì—†ìŒ) -->
  <WorkflowActions
    v-if="selectedTask"
    :task="selectedTask"
  />
</template>
```

### 5.4 ìƒíƒœ ê´€ë¦¬ (Pinia)

```
stores/
â”œâ”€â”€ terminal.ts         # í„°ë¯¸ë„ ì„¸ì…˜ ìƒíƒœ
â””â”€â”€ workflow.ts         # ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ìƒíƒœ
```

**stores/terminal.ts**
```typescript
interface TerminalState {
  sessions: Map<string, TerminalSession>;
  activeSessionId: string | null;
  isConnecting: boolean;
  error: string | null;
}

actions: {
  createSession(taskId: string, projectId: string): Promise<string>;
  closeSession(sessionId: string): Promise<void>;
  sendInput(sessionId: string, input: string): Promise<void>;
  resize(sessionId: string, cols: number, rows: number): Promise<void>;
}
```

**stores/workflow.ts**
```typescript
interface WorkflowState {
  executingCommand: string | null;
  executingTaskId: string | null;
  availableCommands: Record<string, WorkflowCommand[]>;
  lastExecutionResult: WorkflowExecuteResponse | null;
}

actions: {
  executeCommand(taskId: string, command: string, options?: object): Promise<void>;
  fetchAvailableCommands(taskId: string): Promise<WorkflowCommand[]>;
  cancelExecution(): Promise<void>;
}
```

### 5.5 Composables

```
composables/
â”œâ”€â”€ useTerminal.ts      # í„°ë¯¸ë„ ì„¸ì…˜ ê´€ë¦¬
â”œâ”€â”€ useWorkflow.ts      # ì›Œí¬í”Œë¡œìš° ëª…ë ¹ì–´ ê´€ë¦¬
â””â”€â”€ useTerminalResize.ts # í„°ë¯¸ë„ ë¦¬ì‚¬ì´ì¦ˆ ë¡œì§
```

---

## 6. ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

### 6.1 ì„±ëŠ¥

| í•­ëª© | ê¸°ì¤€ |
|------|------|
| í„°ë¯¸ë„ ì—°ê²° | < 500ms |
| ì¶œë ¥ ë Œë”ë§ ì§€ì—° | < 50ms |
| ëª…ë ¹ì–´ ë²„íŠ¼ ë°˜ì‘ | < 100ms |
| í„°ë¯¸ë„ ìŠ¤í¬ë¡¤ | 60fps |

### 6.2 í™•ì¥ì„±

- í„°ë¯¸ë„ ì„¸ì…˜: ë™ì‹œ ìµœëŒ€ 10ê°œ
- ì¶œë ¥ ë²„í¼: ì„¸ì…˜ë‹¹ 10,000ì¤„
- SSE ì—°ê²°: Taskë‹¹ 1ê°œ

### 6.3 ì•ˆì •ì„±

| ì‹œë‚˜ë¦¬ì˜¤ | ì²˜ë¦¬ |
|---------|------|
| ë„¤íŠ¸ì›Œí¬ ëŠê¹€ | ìë™ ì¬ì—°ê²° (3íšŒ ì‹œë„) |
| ì„œë²„ ì¬ì‹œì‘ | ì„¸ì…˜ ë³µêµ¬ ë˜ëŠ” ì¬ìƒì„± |
| ë¸Œë¼ìš°ì € íƒ­ ë‹«í˜ | ì„¸ì…˜ ìë™ ì •ë¦¬ (5ë¶„ íƒ€ì„ì•„ì›ƒ) |
| ëª…ë ¹ì–´ ì‹¤íŒ¨ | ì—ëŸ¬ ë©”ì‹œì§€ + ì¬ì‹œë„ ë²„íŠ¼ |

### 6.4 ì ‘ê·¼ì„±

- í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜: Tabìœ¼ë¡œ ë²„íŠ¼ ì´ë™
- í„°ë¯¸ë„ í°íŠ¸ í¬ê¸° ì¡°ì •: Ctrl+/Ctrl-
- ìŠ¤í¬ë¦° ë¦¬ë”: í„°ë¯¸ë„ ìƒíƒœ ì•Œë¦¼

### 6.5 ë³´ì•ˆ

- í„°ë¯¸ë„ ì„¸ì…˜: ì¸ì¦ëœ ì‚¬ìš©ìë§Œ ìƒì„±
- ëª…ë ¹ì–´ ì‹¤í–‰: í—ˆìš©ëœ `/wf:*` ëª…ë ¹ì–´ë§Œ ì‹¤í–‰
- ì…ë ¥ ê²€ì¦: XSS ë°©ì§€ (DOMPurify)

### 6.6 ë¸Œë¼ìš°ì € í˜¸í™˜ì„±

| ë¸Œë¼ìš°ì € | ìµœì†Œ ë²„ì „ |
|---------|----------|
| Chrome | 90+ |
| Firefox | 88+ |
| Safari | 14+ |
| Edge | 90+ |

---

## 7. ê¸°ìˆ  ìŠ¤íƒ

### 7.1 ì‹ ê·œ íŒ¨í‚¤ì§€

| íŒ¨í‚¤ì§€ | ë²„ì „ | ìš©ë„ |
|--------|------|------|
| xterm | ^5.x | í„°ë¯¸ë„ UI |
| @xterm/addon-fit | ^0.8.x | í„°ë¯¸ë„ ìë™ í¬ê¸° ì¡°ì • |
| node-pty | ^1.0.x | ì„œë²„ í„°ë¯¸ë„ í”„ë¡œì„¸ìŠ¤ |

### 7.2 ê¸°ì¡´ ìŠ¤íƒ (jjiban PRD 1.0)

| ê³„ì¸µ | ê¸°ìˆ  |
|------|------|
| ëŸ°íƒ€ì„ | Node.js 20.x |
| í”„ë ˆì„ì›Œí¬ | Nuxt 3 (Standalone) |
| í”„ë¡ íŠ¸ì—”ë“œ | Vue 3, PrimeVue 4.x, TailwindCSS |
| ì°¨íŠ¸ | Frappe Gantt (Gantt ì°¨íŠ¸ ì‹œê°í™”) |
| ë°ì´í„° | wbs.md + JSON |

---

## 8. ë°ì´í„° íë¦„

### 8.1 ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì‹œí€€ìŠ¤

```
User                   Frontend                 Server                  Claude CLI
  â”‚                        â”‚                        â”‚                        â”‚
  â”œâ”€ [build] í´ë¦­ â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚                        â”‚
  â”‚                        â”œâ”€ POST /workflow/exec â”€>â”‚                        â”‚
  â”‚                        â”‚                        â”œâ”€ ì„¸ì…˜ ìƒì„±              â”‚
  â”‚                        â”‚                        â”œâ”€ node-pty spawn â”€â”€â”€â”€â”€>â”‚
  â”‚                        â”‚<â”€ { sessionId } â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
  â”‚                        â”‚                        â”‚                        â”‚
  â”‚                        â”œâ”€ SSE /session/:id/outâ”€>â”‚                        â”‚
  â”‚                        â”‚<â”€â”€ event: output â”€â”€â”€â”€â”€â”€â”¤<â”€ stdout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚<â”€ í„°ë¯¸ë„ ì¶œë ¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚                        â”‚
  â”‚                        â”‚<â”€â”€ event: status â”€â”€â”€â”€â”€â”€â”¤                        â”‚
  â”‚                        â”‚                        â”‚                        â”‚
  â”‚                        â”‚<â”€â”€ event: complete â”€â”€â”€â”€â”¤<â”€ exit â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚<â”€ ì™„ë£Œ í† ìŠ¤íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚                        â”‚
  â”‚                        â”œâ”€ refreshTaskDetail() â”€>â”‚                        â”‚
  â”‚<â”€ ìƒíƒœ ì—…ë°ì´íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚                        â”‚
```

### 8.2 ì„¸ì…˜ ë¼ì´í”„ì‚¬ì´í´

```
[ë¯¸ì—°ê²°] â”€â”€(Task ì„ íƒ)â”€â”€> [ì—°ê²° ì¤‘] â”€â”€(ì„±ê³µ)â”€â”€> [ì—°ê²°ë¨]
                              â”‚                     â”‚
                              â””â”€â”€(ì‹¤íŒ¨)â”€â”€> [ì—ëŸ¬]   â”‚
                                                    â”‚
                                    [ì‹¤í–‰ ì¤‘] <â”€(ëª…ë ¹ì–´ ì‹¤í–‰)â”€â”˜
                                        â”‚
                                        â””â”€â”€(ì™„ë£Œ/ì—ëŸ¬)â”€â”€> [ì—°ê²°ë¨]

[ì—°ê²°ë¨] â”€â”€(ë‹¤ë¥¸ Task ì„ íƒ)â”€â”€> [ì„¸ì…˜ ì •ë¦¬] â”€â”€> [ë¯¸ì—°ê²°]
```

---

## 9. ì‹¤í–‰ ìƒíƒœ ê´€ë¦¬

### 9.1 ê°œìš”

ì›Œí¬í”Œë¡œìš° ëª…ë ¹ì–´ ì‹¤í–‰ ì¤‘ì¸ Taskë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œì‹œí•˜ê³ , ì¤‘ë³µ ì‹¤í–‰ì„ ë°©ì§€í•©ë‹ˆë‹¤.

### 9.2 WBS íŠ¸ë¦¬ ìŠ¤í”¼ë„ˆ í‘œì‹œ

| í•­ëª© | ì„¤ëª… |
|------|------|
| ìœ„ì¹˜ | ë…¸ë“œ ì•„ì´ì½˜ ì™¼ìª½ |
| í¬ê¸° | 14px Ã— 14px |
| ì¡°ê±´ | Taskê°€ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ì¤‘ì¼ ë•Œ |
| ì»´í¬ë„ŒíŠ¸ | PrimeVue ProgressSpinner |

```
â”Œâ”€ WBS íŠ¸ë¦¬ ë…¸ë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ”„] [TSK] TSK-01-01: ì œëª© [ê¸°ë³¸ì„¤ê³„]           â”‚
â”‚  â†‘                                             â”‚
â”‚ ìŠ¤í”¼ë„ˆ (ì‹¤í–‰ ì¤‘)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€

- ë™ì¼ Taskì— ëŒ€í•´ ì›Œí¬í”Œë¡œìš°ê°€ ì‹¤í–‰ ì¤‘ì´ë©´ ë²„íŠ¼ ë¹„í™œì„±í™”
- íˆ´íŒ: "ì´ë¯¸ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤"
- ì„œë²„ ì¸¡ì—ì„œë„ ì¤‘ë³µ ì‹¤í–‰ ì°¨ë‹¨

### 9.4 Stale Execution ì •ë¦¬

| í•­ëª© | ê°’ |
|------|-----|
| íƒ€ì„ì•„ì›ƒ | 1ì‹œê°„ |
| ì •ë¦¬ ì£¼ê¸° | 5ë¶„ë§ˆë‹¤ |
| ì •ë¦¬ ëŒ€ìƒ | startedAt + 1ì‹œê°„ ê²½ê³¼í•œ ì‹¤í–‰ |

### 9.5 ì‹¤í–‰ ìƒíƒœ API

| Method | Route | ì„¤ëª… |
|--------|-------|------|
| POST | /api/execution/start | ì‹¤í–‰ ì‹œì‘ ë“±ë¡ |
| POST | /api/execution/stop | ì‹¤í–‰ ì¢…ë£Œ ë“±ë¡ |
| GET | /api/execution/status | ì „ì²´ ì‹¤í–‰ ìƒíƒœ ì¡°íšŒ |

**POST /api/execution/start**

Request:
```json
{
  "taskId": "TSK-01-01",
  "command": "build",
  "sessionId": "term-abc123",
  "pid": 1234
}
```

Response:
```json
{
  "success": true,
  "executionId": "exec-uuid-5678"
}
```

**GET /api/execution/status**

Response:
```json
{
  "executions": [
    {
      "taskId": "TSK-01-01",
      "command": "build",
      "sessionId": "term-abc123",
      "pid": 1234,
      "startedAt": "2025-12-17T10:00:00Z"
    }
  ],
  "count": 1
}
```

### 9.6 ì›Œí¬í”Œë¡œìš° ëª…ë ¹ì–´ í›…

í„°ë¯¸ë„ ì„¸ì…˜ ìƒì„± ì‹œ í™˜ê²½ë³€ìˆ˜ë¡œ ì„¸ì…˜ ì •ë³´ë¥¼ ì „ë‹¬í•˜ê³ , wf ëª…ë ¹ì–´ì—ì„œ CLIë¥¼ í†µí•´ APIë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.

**í„°ë¯¸ë„ í™˜ê²½ë³€ìˆ˜ ì„¤ì •:**
```javascript
// server/utils/terminalService.ts
const ptyProcess = pty.spawn(shell, [], {
  env: {
    ...process.env,
    JJIBAN_SESSION_ID: sessionId,
    JJIBAN_TERMINAL_PID: String(ptyProcess.pid)
  }
})
```

**wf ëª…ë ¹ì–´ í›… íë¦„:**
```
[í„°ë¯¸ë„ ì„¸ì…˜ ìƒì„±]
  â†“ env: JJIBAN_SESSION_ID, JJIBAN_TERMINAL_PID
[wf ëª…ë ¹ì–´ ì‹¤í–‰]
  â†“
npx jjiban exec start $TASK_ID $COMMAND \
  --session $JJIBAN_SESSION_ID --pid $JJIBAN_TERMINAL_PID
  â†“
... ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ...
  â†“
npx jjiban exec stop $TASK_ID
[ëª…ë ¹ì–´ ì¢…ë£Œ]
```

### 9.7 CLI exec ëª…ë ¹ì–´

ì‹¤í–‰ ìƒíƒœ APIë¥¼ í˜¸ì¶œí•˜ëŠ” CLI ëª…ë ¹ì–´ì…ë‹ˆë‹¤.

**ì‹œì‘ ë“±ë¡:**
```bash
npx jjiban exec start <taskId> <command> [options]
  --session <sessionId>  í„°ë¯¸ë„ ì„¸ì…˜ ID (í™˜ê²½ë³€ìˆ˜ $JJIBAN_SESSION_ID)
  --pid <pid>            í„°ë¯¸ë„ í”„ë¡œì„¸ìŠ¤ PID (í™˜ê²½ë³€ìˆ˜ $JJIBAN_TERMINAL_PID)
```

**ì¢…ë£Œ ë“±ë¡:**
```bash
npx jjiban exec stop <taskId>
```

**ì˜ˆì‹œ (.claude/commands/wf/build.md):**
```markdown
# ì‹œì‘ ì‹œ
npx jjiban exec start $TASK_ID build --session $JJIBAN_SESSION_ID --pid $JJIBAN_TERMINAL_PID

... ë¹Œë“œ ì›Œí¬í”Œë¡œìš° ë¡œì§ ...

# ì¢…ë£Œ ì‹œ
npx jjiban exec stop $TASK_ID
```

---

## 10. ì›Œí¬í”Œë¡œìš° ì„¤ì • ê¸°ë°˜ ìœ ì—°í™”

### 10.1 ê°œìš”

CLI í•˜ë“œì½”ë”©ëœ ì›Œí¬í”Œë¡œìš°ë¥¼ ì„¤ì • íŒŒì¼ ê¸°ë°˜ìœ¼ë¡œ ì „í™˜í•˜ì—¬ ìœ ì—°í•˜ê²Œ ê´€ë¦¬í•©ë‹ˆë‹¤.

### 10.2 í˜„ì¬ ë¬¸ì œ

| ê³„ì¸µ | íŒŒì¼ | ìƒíƒœ |
|------|------|------|
| Server | `server/utils/settings/defaults.ts` | ì„¤ì • ê¸°ë°˜ (ìœ ì—°) |
| CLI | `cli/config/workflowSteps.js` | í•˜ë“œì½”ë”© (ê²½ì§) |

**ìƒíƒœ ì½”ë“œ ë¶ˆì¼ì¹˜:**
| ìƒíƒœ | Server | CLI |
|------|--------|-----|
| Verify | `[vf]` | `[ts]` |
| Infra Design | `[dd]` | `[ds]` |

### 10.3 í•´ê²° ë°©ì•ˆ

1. **ë‹¨ì¼ ì†ŒìŠ¤ í†µí•©**: `workflows.json`ì„ ìœ ì¼í•œ ì›Œí¬í”Œë¡œìš° ì •ì˜ ì†ŒìŠ¤ë¡œ ì‚¬ìš©
2. **CLI ë¦¬íŒ©í† ë§**: CLIê°€ ì„¤ì • íŒŒì¼ì„ ë¡œë“œí•˜ë„ë¡ ë³€ê²½
3. **ìƒíƒœ ì½”ë“œ í‘œì¤€í™”**: Serverì˜ `[vf]` ê¸°ì¤€ ì±„íƒ

### 10.4 ì„¤ì • íŒŒì¼ êµ¬ì¡°

**`.jjiban/settings/workflows.json` (v2.0 ìŠ¤í‚¤ë§ˆ)**

ì›Œí¬í”Œë¡œìš° ì„¤ì •ì€ v2.0 í™•ì¥ ìŠ¤í‚¤ë§ˆë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. Record ê¸°ë°˜ êµ¬ì¡°ë¡œ ìƒíƒœ, ëª…ë ¹ì–´, ì›Œí¬í”Œë¡œìš°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.

```json
{
  "version": "2.0",
  "states": {
    "[ ]": { "id": "todo", "label": "ì‹œì‘ ì „", "labelEn": "Todo", "icon": "pi-inbox", "color": "#6b7280", "severity": "secondary", "progressWeight": 0 },
    "[bd]": { "id": "basic-design", "label": "ê¸°ë³¸ì„¤ê³„", "labelEn": "Basic Design", "icon": "pi-pencil", "color": "#3b82f6", "severity": "info", "progressWeight": 20 },
    "[dd]": { "id": "detail-design", "label": "ìƒì„¸ì„¤ê³„", "labelEn": "Detail Design", "icon": "pi-file-edit", "color": "#8b5cf6", "severity": "info", "progressWeight": 40 },
    "[ap]": { "id": "approve", "label": "ìŠ¹ì¸", "labelEn": "Approve", "icon": "pi-check-square", "color": "#10b981", "severity": "success", "progressWeight": 50 },
    "[im]": { "id": "implement", "label": "êµ¬í˜„", "labelEn": "Implement", "icon": "pi-code", "color": "#f59e0b", "severity": "warning", "progressWeight": 60 },
    "[vf]": { "id": "verify", "label": "ê²€ì¦", "labelEn": "Verify", "icon": "pi-verified", "color": "#22c55e", "severity": "success", "progressWeight": 80 },
    "[xx]": { "id": "done", "label": "ì™„ë£Œ", "labelEn": "Done", "icon": "pi-check-circle", "color": "#10b981", "severity": "success", "progressWeight": 100 }
  },
  "commands": {
    "start": { "label": "ì‹œì‘", "labelEn": "Start", "icon": "pi-play", "severity": "primary" },
    "draft": { "label": "ìƒì„¸ì„¤ê³„", "labelEn": "Draft", "icon": "pi-pencil", "severity": "info" },
    "approve": { "label": "ìŠ¹ì¸", "labelEn": "Approve", "icon": "pi-check", "severity": "success" },
    "build": { "label": "êµ¬í˜„", "labelEn": "Build", "icon": "pi-wrench", "severity": "warning" },
    "verify": { "label": "ê²€ì¦", "labelEn": "Verify", "icon": "pi-verified", "severity": "success" },
    "done": { "label": "ì™„ë£Œ", "labelEn": "Done", "icon": "pi-check-circle", "severity": "success" }
  },
  "workflows": {
    "development": {
      "name": "Development Workflow",
      "states": ["[ ]", "[bd]", "[dd]", "[ap]", "[im]", "[vf]", "[xx]"],
      "transitions": [
        { "from": "[ ]", "to": "[bd]", "command": "start", "document": "010-basic-design.md" },
        { "from": "[bd]", "to": "[dd]", "command": "draft", "document": "020-detail-design.md" },
        { "from": "[dd]", "to": "[ap]", "command": "approve" },
        { "from": "[ap]", "to": "[im]", "command": "build", "document": "030-implementation.md" },
        { "from": "[im]", "to": "[vf]", "command": "verify", "document": "070-integration-test.md" },
        { "from": "[vf]", "to": "[xx]", "command": "done", "document": "080-manual.md" }
      ],
      "actions": { "[bd]": ["ui"], "[dd]": ["review", "apply"], "[im]": ["test", "audit", "patch"] }
    },
    "defect": {
      "name": "Defect Workflow",
      "states": ["[ ]", "[an]", "[fx]", "[vf]", "[xx]"],
      "transitions": [
        { "from": "[ ]", "to": "[an]", "command": "start", "document": "010-analysis.md" },
        { "from": "[an]", "to": "[fx]", "command": "fix", "document": "020-fix.md" },
        { "from": "[fx]", "to": "[vf]", "command": "verify" },
        { "from": "[vf]", "to": "[xx]", "command": "done" }
      ]
    },
    "infrastructure": {
      "name": "Infrastructure Workflow",
      "states": ["[ ]", "[ds]", "[im]", "[xx]"],
      "transitions": [
        { "from": "[ ]", "to": "[ds]", "command": "start", "document": "010-design.md" },
        { "from": "[ ]", "to": "[im]", "command": "skip" },
        { "from": "[ds]", "to": "[im]", "command": "build", "document": "030-implementation.md" },
        { "from": "[im]", "to": "[xx]", "command": "done" }
      ]
    }
  }
}
```

**ìŠ¤í‚¤ë§ˆ êµ¬ì¡° ì„¤ëª…:**

| ì„¹ì…˜ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| `states` | `Record<string, StateDefinition>` | ìƒíƒœ ì½”ë“œ â†’ UI ì •ë³´ ë§¤í•‘ |
| `commands` | `Record<string, CommandDefinition>` | ëª…ë ¹ì–´ â†’ UI ì •ë³´ ë§¤í•‘ |
| `workflows` | `Record<string, WorkflowDefinition>` | ì¹´í…Œê³ ë¦¬ â†’ ì›Œí¬í”Œë¡œìš° ì •ì˜ |

**v1.0 â†’ v2.0 ì£¼ìš” ë³€ê²½:**

| í•­ëª© | v1.0 | v2.0 |
|------|------|------|
| workflows êµ¬ì¡° | Array (idë¡œ ê²€ìƒ‰) | Record (ì¹´í…Œê³ ë¦¬ í‚¤ë¡œ ì§ì ‘ ì ‘ê·¼) |
| ìƒíƒœ ì •ì˜ | ì—†ìŒ | states ì„¹ì…˜ì— UI ì •ë³´ í¬í•¨ |
| ëª…ë ¹ì–´ ì •ì˜ | ì—†ìŒ | commands ì„¹ì…˜ì— UI ì •ë³´ í¬í•¨ |
| ì ‘ê·¼ ë°©ì‹ | `workflows.find(w => w.id === category)` | `workflows[category]` |

### 10.5 í•˜ìœ„ í˜¸í™˜ì„±

- ê¸°ì¡´ `[ts]` ìƒíƒœ WBS íŒŒì¼ì€ ëŸ°íƒ€ì„ì— `[vf]`ë¡œ ë§¤í•‘
- ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜: ì‹ ê·œ TaskëŠ” `[vf]` ì‚¬ìš©
- ì„¤ì • íŒŒì¼ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’(defaults.ts) í´ë°±

### 10.6 êµ¬í˜„ ë²”ìœ„

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© |
|------|----------|
| `cli/config/settingsLoader.js` | ì‹ ê·œ - ì„¤ì • íŒŒì¼ ë¡œë“œ |
| `cli/config/defaultWorkflows.js` | ì‹ ê·œ - CLIìš© ê¸°ë³¸ê°’ |
| `cli/config/workflowBuilder.js` | ì‹ ê·œ - ì„¤ì •â†’ë‹¨ê³„ ë³€í™˜ |
| `cli/config/workflowSteps.js` | ìˆ˜ì • - ë™ì  ë¡œë“œ ì „í™˜ |
| `cli/core/WbsReader.js` | ìˆ˜ì • - ìƒíƒœ ì½”ë“œ ì •ê·œí™” |
| `.claude/includes/wf-common-lite.md` | ìˆ˜ì • - ìƒíƒœ ì½”ë“œ í†µì¼ |

---

## 11. ì˜ì¡´ê´€ê³„ ê·¸ë˜í”„ ì‹œê°í™”

### 11.1 ê°œìš”

Task ê°„ ì˜ì¡´ê´€ê³„ë¥¼ ì¸í„°ë™í‹°ë¸Œ ê·¸ë˜í”„ë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤. ì™¼ìª½ì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì˜ì¡´ íë¦„ì„ í‘œí˜„í•˜ì—¬ í”„ë¡œì íŠ¸ êµ¬ì¡°ë¥¼ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 11.2 í•µì‹¬ ê¸°ëŠ¥

| ê¸°ëŠ¥ | ì„¤ëª… |
|------|------|
| Hierarchical Layout | ì™¼ìª½(ë…ë¦½) â†’ ì˜¤ë¥¸ìª½(ì˜ì¡´) ë°©í–¥ |
| ì¸í„°ë™í‹°ë¸Œ | ë…¸ë“œ ë“œë˜ê·¸, ì¤Œ, íŒ¬, í´ë¦­ |
| ëª¨ë‹¬ í˜•íƒœ | ë²„íŠ¼ í´ë¦­ ì‹œ ì „ì²´í™”ë©´ ëª¨ë‹¬ |
| ì „ì²´ í”„ë¡œì íŠ¸ | ëª¨ë“  Task ì˜ì¡´ê´€ê³„ í‘œì‹œ |

### 11.3 ë¼ì´ë¸ŒëŸ¬ë¦¬

**vis-network** ì„ íƒ

| ê¸°ì¤€ | vis-network | Cytoscape.js | D3+Dagre |
|------|-------------|--------------|----------|
| í•™ìŠµê³¡ì„  | âœ… ë‚®ìŒ | ì¤‘ê°„ | ë†’ìŒ |
| Hierarchical LR | âœ… ê¸°ë³¸ì œê³µ | í™•ì¥í•„ìš” | dagre í•„ìš” |
| Vue 3 í†µí•© | âœ… ì‰¬ì›€ | ì¤‘ê°„ | ì–´ë ¤ì›€ |

### 11.4 UI ì„¤ê³„

```
+------------------------------------------+
| ì˜ì¡´ê´€ê³„ ê·¸ë˜í”„                    [X]   |
+------------------------------------------+
| [ì¹´í…Œê³ ë¦¬ â–¼] [ìƒíƒœ â–¼] [ì¤Œ ë¦¬ì…‹]          |
+------------------------------------------+
|                                          |
|  [TSK-01] â”€â”€â†’ [TSK-02] â”€â”€â†’ [TSK-04]     |
|      â”‚                         â†‘         |
|      â””â”€â”€â†’ [TSK-03] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         |
|                                          |
+------------------------------------------+
| â— ê°œë°œ  â— ê²°í•¨  â— ì¸í”„ë¼                 |
+------------------------------------------+
```

### 11.5 ë…¸ë“œ ìŠ¤íƒ€ì¼

| ì¹´í…Œê³ ë¦¬ | ìƒ‰ìƒ |
|----------|------|
| development | `#3b82f6` (íŒŒë‘) |
| defect | `#ef4444` (ë¹¨ê°•) |
| infrastructure | `#22c55e` (ë…¹ìƒ‰) |

### 11.6 ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

```
app/components/wbs/graph/
â”œâ”€â”€ DependencyGraphModal.vue   # PrimeVue Dialog ëª¨ë‹¬
â”œâ”€â”€ DependencyGraph.vue        # vis-network ìº”ë²„ìŠ¤
â””â”€â”€ GraphLegend.vue            # ë²”ë¡€
```

### 11.7 ë°ì´í„° íë¦„

```
wbsStore.flatNodes â†’ useDependencyGraph.buildGraphData() â†’ GraphData { nodes[], edges[] }
```

---

## ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|-----------|
| 1.0 | 2025-12-17 | 2ì°¨ ë²”ìœ„ PRD ì‘ì„± (í„°ë¯¸ë„ í†µí•© + ì›Œí¬í”Œë¡œìš° ì‹¤í–‰) |
| 1.1 | 2025-12-17 | í„°ë¯¸ë„ ì „ì—­ ê´€ë¦¬, ë‹¨ì¼ ì‹¤í–‰ ë©”ì»¤ë‹ˆì¦˜, ì‹¤í–‰ ìƒíƒœ PID ì¶”ì  ì¶”ê°€ |
| 1.2 | 2025-12-17 | ì›Œí¬í”Œë¡œìš° ì„¤ì • ê¸°ë°˜ ìœ ì—°í™” ì„¹ì…˜ ì¶”ê°€ |
| 1.3 | 2025-12-17 | ì˜ì¡´ê´€ê³„ ê·¸ë˜í”„ ì‹œê°í™” ì„¹ì…˜ ì¶”ê°€ |
| 1.4 | 2025-12-17 | **í„°ë¯¸ë„ êµ¬í˜„ ë°©ì‹ ë³€ê²½**: xterm.js + node-pty ê¸°ë°˜ í„°ë¯¸ë„ ì—ë®¬ë ˆì´í„° ì œê±°. child_process.spawn() + SSE ìŠ¤íŠ¸ë¦¬ë° ê¸°ë°˜ ë‹¨ìˆœ í…ìŠ¤íŠ¸ ì¶œë ¥ìœ¼ë¡œ ë³€ê²½. Task ìƒì„¸ íŒ¨ë„ ë‚´ì—ì„œ Claude Code CLI ì‹¤í–‰ ê²°ê³¼ë¥¼ í‘œì‹œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë‹¨ìˆœí™”. |
| 1.5 | 2025-12-18 | **ì›Œí¬í”Œë¡œìš° ìŠ¤í‚¤ë§ˆ v2.0 ë§ˆì´ê·¸ë ˆì´ì…˜**: ì„¹ì…˜ 10.4 ì—…ë°ì´íŠ¸. Array ê¸°ë°˜ v1.0 â†’ Record ê¸°ë°˜ v2.0 ìŠ¤í‚¤ë§ˆë¡œ ë³€ê²½. states/commands/workflows ì„¹ì…˜ ë¶„ë¦¬, UI ì •ë³´ í¬í•¨. |
